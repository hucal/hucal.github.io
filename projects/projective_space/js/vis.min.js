var add_all,c,camera,camera_far,clear_scene,color_dir,colors,container,controls,current_color,i,j,k,l,len,len1,lines,m,m_,make_rotation,max,obj,points,r2,r2_canvas,r2_points,r2_resolution,r2_stage,r2_texture,r3_points,read_input_matrix,redraw,ref,ref1,ref2,render,renderer,s,s2,s2_points,scene,show_r2,show_r3,show_s2,t,theta,trans_r2_plane,transform,write_input_matrix,x,y;for(Detector.webgl||Detector.addGetWebGLMessage,container=document.getElementById("vis"),scene=new THREE.Scene,scene.fog=new THREE.FogExp2(16777215,.002),camera_far=1e4,camera=new THREE.PerspectiveCamera(75,container.offsetWidth/container.offsetHeight,.1,camera_far),renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setSize(container.offsetWidth,container.offsetHeight),renderer.setClearColor(scene.fog.color,1),renderer.setPixelRatio(window.devicePixelRatio),container.appendChild(renderer.domElement),window.addEventListener("resize",function(){return camera.aspect=container.offsetWidth/container.offsetHeight,camera.updateProjectionMatrix(),renderer.setSize(container.offsetWidth,container.offsetHeight)}),r2_canvas=document.createElement("canvas"),r2_resolution=1024,r2_canvas.width=r2_canvas.height=r2_resolution,r2_stage=new createjs.Stage(r2_canvas),make_plane(root_objects,2,12320699),make_point(root_objects,.02,16777215,1,50),s2=make_point(s2_points,2,1052688,1,50),r2_texture=new THREE.Texture(r2_canvas),r2_texture.needsUpdate=!0,r2=new THREE.Mesh(new THREE.PlaneGeometry(2,2),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:r2_texture,transparent:!0})),r2.position.z=1,max=10,i=j=ref=-max,ref1=max;ref1>=ref?ref1>=j:j>=ref1;i=ref1>=ref?++j:--j)r2_stage.addChild(canvas_line([i/max,1],[i/max,-1],2236962,1)),r2_stage.addChild(canvas_line([1,i/max],[-1,i/max],2236962,1));for(scene.add(new THREE.AmbientLight(4210752)),scene.add(new THREE.HemisphereLight(16777215,4210752,1)),k=0,len=root_objects.length;len>k;k++)obj=root_objects[k],scene.add(obj);for(x=y=.1,theta=PI/4,c=Math.cos(theta),s=Math.sin(theta),m=(new THREE.Matrix3).set(c,.1,x,0,s,y,0,.4,1),t=function(e,r){return array2_from_vec3(vec3_from_array(r).applyMatrix3(e))},points=[{p:[0,0],c:16711680},{p:[.5,.5],c:16711920},{p:[-.4,.6],c:16773120}],lines=[{p1:[.2,.2],p2:[-.3,.4],c:696575},{p1:[-.2,-.1],p2:[0,.1],c:1044650}],r2_points=new Array,s2_points=new Array,r3_points=new Array,clear_scene=function(){var e,r,t,n,a,o,i,c;for(i=[r2],e=0,r=i.length;r>e;e++)obj=i[e],obj.updateMatrix(),obj.position.set(0,0,0),obj.rotation.set(0,0,0),obj.scale.set(1,1,1),obj.updateMatrix(),scene.remove(obj);for(r2.position.z=1,c=r3_points.concat(s2_points),a=0,t=c.length;t>a;a++)obj=c[a],scene.remove(obj);for(o=0,n=r2_points.length;n>o;o++)obj=r2_points[o],r2_stage.removeChild(obj);return r2_stage.update(),r2.material.map.needsUpdate=!0,r2_points=new Array,s2_points=new Array,r3_points=new Array},m_=0,add_all=function(e,r,n,a,o){var i,s,l,_,p,u,d,m,f,h,w,x,E,b;for(null==r&&(r=!0),null==n&&(n=!0),null==a&&(a=!0),null==o&&(o=!1),i=0,s=points.length;s>i;i++)f=points[i],make_p_point(t(e,f.p),f.p,f.c,o);for(d=0,l=lines.length;l>d;d++)f=lines[d],make_p_line(t(e,f.p1),t(e,f.p2),f.p1,f.p2,f.c,1,!0,o);if(a)for(m=0,_=r3_points.length;_>m;m++)obj=r3_points[m],scene.add(obj);if(n)for(h=0,p=s2_points.length;p>h;h++)obj=s2_points[h],scene.add(obj);if(r){for(scene.add(r2),x=0,u=r2_points.length;u>x;x++)obj=r2_points[x],r2_stage.addChild(obj);if(o){for(m_=(new THREE.Matrix4).identity(),w=E=0;2>=E;w=++E)for(c=b=0;2>=b;c=++b)m_.elements[4*w+c]=e.elements[3*w+c];r2.applyMatrix(m_),r2.updateMatrix(),console.log(r2.matrix)}}return r2_stage.update(),r2.material.map.needsUpdate=!0},transform=new THREE.Matrix3,show_r2=show_s2=show_r3=!0,trans_r2_plane=!1,redraw=function(){return clear_scene(),add_all(transform,show_r2,show_s2,show_r3,trans_r2_plane)},camera.position.z=3,theta=1*-PI/2,camera.position.y=2.5*Math.sin(theta),camera.position.x=2.5*Math.cos(theta),controls=new THREE.OrbitControls(camera,renderer.domElement),controls.enableDamping=!0,controls.dampingFactor=1,controls.enablePan=!1,render=function(){return requestAnimationFrame(render),renderer.render(scene,camera),controls.update()},write_input_matrix=function(e,r,t){var n,a,o,i;for(null==r&&(r=3),null==t&&(t="input#trans_"),i=[],a=n=1,o=r;o>=1?o>=n:n>=o;a=o>=1?++n:--n)i.push(function(){var n,o,i;for(i=[],c=n=1,o=r;o>=1?o>=n:n>=o;c=o>=1?++n:--n)i.push($(t+(""+a)+(""+c)).val(e.elements[(c-1)*r+(a-1)]));return i}());return i},read_input_matrix=function(e,r){var t,n,a,o,i,s;for(null==e&&(e=3),null==r&&(r="input#trans_"),t=Array(e*e),o=n=1,i=e;i>=1?i>=n:n>=i;o=i>=1?++n:--n)for(c=a=1,s=e;s>=1?s>=a:a>=s;c=s>=1?++a:--a)t[(c-1)*e+(o-1)]=parseFloat($(r+(""+o)+(""+c)).val());return(new THREE.Matrix3).fromArray(t)},ref2=[{checkbox:"input#show_r2",f:function(){return show_r2=this.checked,redraw()}},{checkbox:"input#show_s2",f:function(){return show_s2=this.checked,redraw()}},{checkbox:"input#show_r3",f:function(){return show_r3=this.checked,redraw()}}],l=0,len1=ref2.length;len1>l;l++)c=ref2[l],$(c.checkbox).prop("checked",!0).change(c.f);$("button#apply_trans").click(function(){return transform=read_input_matrix(),trans_r2_plane=!1,redraw()}),$("button#apply_trans_plane").click(function(){return transform=read_input_matrix(),trans_r2_plane=!0,redraw()}),THREE.Matrix3.prototype.multiply=function(e){return this.multiplyMatrices(this,e)},THREE.Matrix3.prototype.multiplyMatrices=function(e,r){var t,n,a,o,i,c,s,l,_,p,u,d,m,f,h,w,x,E,b,v;return p=e.elements,v=r.elements,t=p[0],n=p[3],a=p[6],o=p[1],i=p[4],c=p[7],s=p[2],l=p[5],_=p[8],u=v[0],d=v[3],m=v[6],f=v[1],h=v[4],w=v[7],x=v[2],E=v[5],b=v[8],p[0]=t*u+t*d+t*m,p[3]=n*f+n*h+n*w,p[6]=a*x+a*E+a*b,p[1]=o*u+o*d+o*m,p[4]=i*f+i*h+i*w,p[7]=c*x+c*E+c*b,p[2]=s*u+s*d+s*m,p[5]=l*f+l*h+l*w,p[8]=_*x+_*E+_*b,e},make_rotation=function(e,r,t){return null==r&&(r=1),null==t&&(t=!1),(new THREE.Matrix3).set(r*(t?-1:1)*Math.cos(e),-r*Math.sin(e),0,r*(t?-1:1)*Math.sin(e),r*Math.cos(e),0,0,0,1)},$("button#create_sim").click(function(){var e,r,t,n;return e="input#sim_",s=parseFloat($(e+"s").val()),theta=parseFloat($(e+"theta").val()),theta=PI*theta/180,t=parseFloat($(e+"tx").val()),n=parseFloat($(e+"ty").val()),r=$(e+"reflection").prop("checked"),m=make_rotation(theta,s,r),m.elements[6]=t,m.elements[7]=n,write_input_matrix(m)}),$("button#create_identity").click(function(){return write_input_matrix((new THREE.Matrix3).identity())}),$("button#apply_identity").click(function(){return transform=(new THREE.Matrix3).identity(),redraw()}),$("button#create_aff").click(function(){var e,r,t,n,a,o,i;return n="input#aff_",theta=parseFloat($(n+"theta").val()),theta=PI*theta/180,t=parseFloat($(n+"phi").val()),t=PI*t/180,e=parseFloat($(n+"l1").val()),r=parseFloat($(n+"l2").val()),o=parseFloat($(n+"tx").val()),i=parseFloat($(n+"ty").val()),a=$(n+"reflection").prop("checked"),console.log(theta,t,e,r,o,i,a),m=make_rotation(theta,1,a).multiply(make_rotation(-t).multiply((new THREE.Matrix3).set(e,0,0,0,r,0,0,0,1).multiply(make_rotation(t)))),m.elements[6]=o,m.elements[7]=i,write_input_matrix(m)}),colors=[function(){var e,r,t,n;for(t=["#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],n=[],r=0,e=t.length;e>r;r++)c=t[r],n.push(parseInt(c.substr(1),16));return n}()][0],current_color=0,color_dir=1,$("button#add_point").click(function(){return 0>current_color+color_dir&&(color_dir=1),current_color+color_dir>colors.length-1&&(color_dir=-1),current_color+=color_dir,x=parseFloat($("input#point_x").val()),y=parseFloat($("input#point_y").val()),points.push({p:[x,y],c:colors[current_color]}),redraw()}),$("button#add_line").click(function(){var e,r;return 0>current_color+color_dir&&(color_dir=1),current_color+color_dir>colors.length-1&&(color_dir=-1),current_color+=color_dir,e=parseFloat($("input#line_a").val()),r=parseFloat($("input#line_b").val()),c=parseFloat($("input#line_c").val()),lines.push({p1:[1,(e-c)/r],p2:[c/e,0],c:colors[current_color]}),redraw()}),$("button#clear_all").click(function(){return lines=[],points=[],clear_scene()}),redraw(),render();
//# sourceMappingURL=vis.min.js.map