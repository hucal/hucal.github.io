var add_all,c,camera,camera_far,clear_scene,container,controls,i,j,k,l,len,len1,lines,m,max,obj,points,r2,r2_canvas,r2_points,r2_resolution,r2_stage,r2_texture,r3_points,read_input_matrix,redraw,ref,ref1,ref2,render,renderer,s,s2,s2_points,scene,show_r2,show_r3,show_s2,t,theta,transform,write_input_matrix,x,y;for(Detector.webgl||Detector.addGetWebGLMessage,container=document.getElementById("vis"),scene=new THREE.Scene,scene.fog=new THREE.FogExp2(16777215,.002),camera_far=1e4,camera=new THREE.PerspectiveCamera(75,container.offsetWidth/container.offsetHeight,.1,camera_far),renderer=new THREE.WebGLRenderer({antialias:!0}),renderer.setSize(container.offsetWidth,container.offsetHeight),renderer.setClearColor(scene.fog.color,1),renderer.setPixelRatio(window.devicePixelRatio),container.appendChild(renderer.domElement),window.addEventListener("resize",function(){return camera.aspect=container.offsetWidth/container.offsetHeight,camera.updateProjectionMatrix(),renderer.setSize(container.offsetWidth,container.offsetHeight)}),r2_canvas=document.createElement("canvas"),r2_resolution=1024,r2_canvas.width=r2_canvas.height=r2_resolution,r2_stage=new createjs.Stage(r2_canvas),make_plane(root_objects,2,12320699),make_point(root_objects,.02,16777215,1,50),s2=make_point(s2_points,2,1052688,1,50),r2_texture=new THREE.Texture(r2_canvas),r2_texture.needsUpdate=!0,r2=new THREE.Mesh(new THREE.PlaneGeometry(2,2),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:r2_texture,transparent:!0})),r2.position.z=1,max=10,i=j=ref=-max,ref1=max;ref1>=ref?ref1>=j:j>=ref1;i=ref1>=ref?++j:--j)r2_stage.addChild(canvas_line([i/max,1],[i/max,-1],2236962,1)),r2_stage.addChild(canvas_line([1,i/max],[-1,i/max],2236962,1));for(scene.add(new THREE.AmbientLight(4210752)),scene.add(new THREE.HemisphereLight(16777215,4210752,1)),k=0,len=root_objects.length;len>k;k++)obj=root_objects[k],scene.add(obj);for(x=y=.1,theta=PI/4,c=Math.cos(theta),s=Math.sin(theta),m=(new THREE.Matrix3).set(c,.1,x,0,s,y,0,.4,1),t=function(e,r){return array2_from_vec3(vec3_from_array(r).applyMatrix3(e))},points=[{p:[0,0],c:16711680},{p:[.5,.5],c:16711920},{p:[-.4,.6],c:16773120}],lines=[{p1:[.2,.2],p2:[-.3,.4],c:696575},{p1:[-.2,-.1],p2:[0,.1],c:1044650}],r2_points=new Array,s2_points=new Array,r3_points=new Array,clear_scene=function(){var e,r,t,n,a;for(a=r3_points.concat(s2_points),e=0,r=a.length;r>e;e++)obj=a[e],scene.remove(obj);for(scene.remove(r2),n=0,t=r2_points.length;t>n;n++)obj=r2_points[n],r2_stage.removeChild(obj);return r2_stage.update(),r2.material.map.needsUpdate=!0,r2_points=new Array,s2_points=new Array,r3_points=new Array},add_all=function(e,r,n,a){var o,s,i,c,l,p,_,d,h,u,f;for(null==r&&(r=!0),null==n&&(n=!0),null==a&&(a=!0),o=0,s=points.length;s>o;o++)h=points[o],make_p_point(t(e,h.p),h.c);for(_=0,i=lines.length;i>_;_++)h=lines[_],make_p_line(t(e,h.p1),t(e,h.p2),h.c,1,!0);if(a)for(d=0,c=r3_points.length;c>d;d++)obj=r3_points[d],scene.add(obj);if(n)for(u=0,l=s2_points.length;l>u;u++)obj=s2_points[u],scene.add(obj);if(r)for(scene.add(r2),f=0,p=r2_points.length;p>f;f++)obj=r2_points[f],r2_stage.addChild(obj);return r2_stage.update(),r2.material.map.needsUpdate=!0},transform=new THREE.Matrix3,show_r2=show_s2=show_r3=!0,redraw=function(){return clear_scene(),add_all(transform,show_r2,show_s2,show_r3)},camera.position.z=3,theta=1*-PI/2,camera.position.y=2.5*Math.sin(theta),camera.position.x=2.5*Math.cos(theta),controls=new THREE.OrbitControls(camera,renderer.domElement),controls.enableDamping=!0,controls.dampingFactor=1,controls.enablePan=!1,render=function(){return requestAnimationFrame(render),renderer.render(scene,camera),controls.update()},write_input_matrix=function(e,r,t){var n,a,o,s;for(null==r&&(r=3),null==t&&(t="input#trans_"),s=[],a=n=1,o=r;o>=1?o>=n:n>=o;a=o>=1?++n:--n)s.push(function(){var n,o,s;for(s=[],c=n=1,o=r;o>=1?o>=n:n>=o;c=o>=1?++n:--n)s.push($(t+(""+a)+(""+c)).val(e.elements[(c-1)*r+(a-1)]));return s}());return s},read_input_matrix=function(e,r){var t,n,a,o,s,i;for(null==e&&(e=3),null==r&&(r="input#trans_"),t=Array(e*e),o=n=1,s=e;s>=1?s>=n:n>=s;o=s>=1?++n:--n)for(c=a=1,i=e;i>=1?i>=a:a>=i;c=i>=1?++a:--a)t[(c-1)*e+(o-1)]=parseFloat($(r+(""+o)+(""+c)).val());return(new THREE.Matrix3).fromArray(t)},ref2=[{checkbox:"input#show_r2",f:function(){return show_r2=this.checked,redraw()}},{checkbox:"input#show_s2",f:function(){return show_s2=this.checked,redraw()}},{checkbox:"input#show_r3",f:function(){return show_r3=this.checked,redraw()}}],l=0,len1=ref2.length;len1>l;l++)c=ref2[l],$(c.checkbox).prop("checked",!0).change(c.f);$("button#apply_trans").click(function(){return transform=read_input_matrix(),redraw()}),$("button#create_sim").click(function(){var e,r,t;return e="input#sim_",s=parseFloat($(e+"s").val()),theta=parseFloat($(e+"theta").val()),theta=PI*theta/180,r=parseFloat($(e+"tx").val()),t=parseFloat($(e+"ty").val()),m=(new THREE.Matrix3).set(s*Math.cos(theta),-s*Math.sin(theta),r,s*Math.sin(theta),s*Math.cos(theta),t,0,0,1),write_input_matrix(m)}),$("button#add_point").click(function(){return x=parseFloat($("input#point_x").val()),y=parseFloat($("input#point_y").val()),points.push({p:[x,y],c:0}),redraw()}),$("button#add_line").click(function(){var e,r;return e=parseFloat($("input#line_a").val()),r=parseFloat($("input#line_b").val()),c=parseFloat($("input#line_c").val()),lines.push({p1:[0,-c/r],p2:[-c/e,0],c:0}),redraw()}),$("button#clear_all").click(function(){return lines=[],points=[],clear_scene()}),redraw(),render();
//# sourceMappingURL=vis.min.js.map