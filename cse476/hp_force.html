<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Hive Plot vs Force Directed Layout</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="../apple-touch-icon.png">

        <link rel="stylesheet" href="../css/normalize.css">
        <link rel="stylesheet" href="../css/main.css">
        <link rel="stylesheet" href="hp_force.css">
        <link rel="stylesheet" href="trade/style.css">
        <script src="../js/vendor/modernizr-2.8.3.min.js"></script>
        <style>
body{ max-width: 1200px; }
#vis, #vis_force{ text-align: center; }
        </style>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <p><a href=http://hiveplot.net/>Hive Plot</a> and Force Layout brushing
        visualization.
        Made using D3, the D3 Hive Plot plugin, and the force directed layout
        is from <a href="http://bl.ocks.org/mbostock/1153292">one of Mike Bostock's bl.ocks</a>.
        Click nodes and links on either vis.
        Data is randomly generated on page load.

        <p style="text-align:center"><button id="begin_tut">Begin tutorial</button></p>
        <div class="hfill"/>
        <br/>
        <table>
        <tr>
            <td/>
            <td>Nodes: <input id="node_count" type="number" min="0" value="10"> </td>
            <td>Links: <input id="link_count" type="number" min="0" value="15"> </td>
            <td/>
        </tr>
        <tr>
            <td><input id="draw_nodes" type="checkbox" checked="checked">draw nodes? </td>
            <td><input id="draw_force" type="checkbox" checked="checked">draw force layout? </td>
            <td>Axis assignment: <select id="axis_func">
            </select></td>
            <td>Radius assignment: <select id="radius_func">
            </select></td>
        </tr>
        </table>

        <div id="node-stats"></div>
        <div id="vis"></div>
        <div id="vis_force"></div>
        <div class="hfill"></div>
        <br/>
        <h2>Data dump</h2>
        <div id="data-dump"></div>
        <header>Hugo Rivera, 2015 <a href=../index.html>home</a></header>

<script src="lib/jquery-1.10.2.min.js"></script>
<script src="lib/colorbrewer.js"></script>
<script src="lib/d3.v3.min.js"></script>
<script src="d3.hive.v0.dev.js"></script>
<script src="hp.js"></script>
<script src="hp_force.js"></script>
<script>
// write data statistics
var vis = draw_hp_force();
function redraw() {
    d3.selectAll("div#vis svg").remove();
    if (config.nodes != vis.nodes.length || config.links != vis.links.length) {
        $("div#data-dump")
            .text(JSON.stringify({nodes:vis.nodes, links:vis.links}, null, 2));
        vis = draw_hp_force();
    } else {
        vis = draw_hp_force(vis.nodes, vis.links);
    }
    d3.selectAll('div#node-stats p').remove();
    d3.select('div#node-stats').append('p')
    .text('Node count: ' + vis.nodes.length +
          '; link count: ' +  vis.links.length);
}
$("div#data-dump")
    .text(JSON.stringify({nodes:vis.nodes, links:vis.links}, null, 2));

function obj_keys(obj) {
    keys = [];
    for (var i in obj)
        if (obj.hasOwnProperty(i))
            keys.push(i);
    return keys;
}

d3.select("select#axis_func")
    .attr("onchange", "config.axis_by_what=this.value; redraw();")
    .selectAll("option")
    .data(obj_keys(axis_assign))
  .enter().append("option")
    .each(function(d) { if (d === config.axis_by_what)
        d3.select(this).attr("selected", "selected"); })
    .attr("value", function(i) {return i;})
    .text(function(i) {return i.replace(/_/g, " ");});

d3.select("select#radius_func")
    .attr("onchange", "config.radius_by_what=this.value; redraw();")
    .selectAll("option")
    .data(obj_keys(radius_assign))
  .enter().append("option")
    .each(function(d) { if (d === config.radius_by_what)
        d3.select(this).attr("selected", "selected"); })
    .attr("value", function(i) {return i;})
    .text(function(i) {return i.replace(/_/g, " ");});

d3.select("input#node_count")
    .attr("value", config.nodes)
    .attr("onchange", "update_config('nodes', this.value); redraw();");

d3.select("input#link_count")
    .attr("value", config.links)
    .attr("onchange", "update_config('links', this.value); redraw();");

d3.select("input#draw_nodes")
.attr("onchange", "config.draw_nodes=this.checked; redraw(); ")

d3.select("input#draw_force")
.attr("onchange", "config.draw_force=this.checked; redraw(); ")

d3.select("input#draw_links")

// should update query string
function update_config(k, new_k) {
    config[k] = new_k;
}
</script>
</body>
</html>

